import{c as D,r as s,t as O,j as e,m as f,B as Y,U as ae,s as pe,A as le,a as A,I as fe,R as qe,S as Be,L as We,p as Ie,b as Oe}from"./index-D7he1i6_.js";import{A as we,b as ge,a as ve}from"./avatar-CAwhaa4I.js";import{S as re,I as Ne,P as Qe}from"./send-BeB6MeHC.js";import{c as M}from"./utils-Bz25wyST.js";import{V as Ke}from"./volume-x-BpyXwvjb.js";import{a as Xe,V as G,M as Ye}from"./volume-2-COawAZmK.js";import{X as H}from"./x-JNGtBUds.js";import{P as ye}from"./phone-Dy7tlZxu.js";import{C as be,M as Ge}from"./mail-WtZP63Xc.js";import{B as Je}from"./bell-C6o2Pif4.js";import{U as Ze}from"./users-CWNW1A_V.js";import{C as oe}from"./check-BpMlry6P.js";import{S as je}from"./search-BeOaeq5H.js";import{E as ke}from"./ellipsis-vertical-Behnx7gN.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],tt=D("ban",et);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],it=D("check-check",st);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],lt=D("circle-help",at);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Ce=D("download",rt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],nt=D("external-link",ot);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],J=D("file-text",ct);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],xt=D("flag",dt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Z=D("link",ht);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]],Se=D("list-filter",mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],pt=D("paperclip",ut);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],bt=D("pause",ft);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Me=D("pencil",jt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],gt=D("play",wt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]],Te=D("reply",vt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],yt=D("star",Nt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Ct=D("timer",kt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Re=D("trash-2",St);function Mt({onSend:a,onCancel:n}){const[r,w]=s.useState(0),[d,g]=s.useState(new Array(25).fill(0)),h=s.useRef(null),C=s.useRef([]),y=s.useRef(0),k=s.useRef(!1),t=s.useRef(null),c=s.useRef(null),l=s.useRef(null),v=s.useCallback(async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){O.error("Microphone access is blocked! ðŸš«"),n();return}const p=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),x=new(window.AudioContext||window.webkitAudioContext);x.state==="suspended"&&await x.resume();const u=x.createMediaStreamSource(p),U=x.createGain();U.gain.value=3;const $=x.createAnalyser();$.fftSize=64;const _=x.createMediaStreamDestination();u.connect(U),U.connect(_),U.connect($),t.current=x,c.current=$;const o=$.frequencyBinCount,m=new Uint8Array(o);y.current=Date.now(),k.current=!0,w(0);const j=()=>{if(!k.current)return;if(c.current){c.current.getByteFrequencyData(m);const q=[],N=Math.floor(o/25);for(let L=0;L<25;L++)q.push(Math.max(4,m[L*N]||0));g(q)}const F=(Date.now()-y.current)/1e3;w(F),l.current=requestAnimationFrame(j)};let R={audioBitsPerSecond:128e3};const z=["audio/webm;codecs=opus","audio/webm","audio/mp4","audio/aac"];for(const F of z)if(MediaRecorder.isTypeSupported(F)){R.mimeType=F;break}const E=new MediaRecorder(_.stream,R);h.current=E,C.current=[],E.ondataavailable=F=>{F.data.size>0&&C.current.push(F.data)},E.onstop=()=>{p.getTracks().forEach(F=>F.stop()),t.current&&t.current.close()},E.start(100),j()}catch(p){console.error("Microphone error:",p),O.error("Unable to access microphone: "+p.message),n()}},[n]),b=s.useCallback(()=>{if(h.current&&k.current){const p=(Date.now()-y.current)/1e3;h.current.onstop=()=>{const x=new Blob(C.current,{type:h.current.mimeType});a(x,p)},h.current.stop(),k.current=!1}},[a]),S=s.useCallback(()=>{h.current&&k.current&&(h.current.onstop=()=>{C.current=[]},h.current.stop(),k.current=!1),n()},[n]);s.useEffect(()=>(v(),()=>{k.current&&h.current&&h.current.stop(),l.current&&cancelAnimationFrame(l.current),t.current&&t.current.close()}),[]);const T=p=>{const x=Math.floor(p/60),u=Math.floor(p%60);return`${x}:${u.toString().padStart(2,"0")}`};return e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mx-auto w-full max-w-[220px] flex items-center justify-between gap-2 px-3 h-12 bg-slate-800/40 rounded-full border border-white/10 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{onClick:S,variant:"ghost",size:"icon",className:"text-slate-400 hover:text-red-400 rounded-full h-9 w-9 transition-colors flex-shrink-0",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f.div,{animate:{opacity:[1,.5,1]},transition:{repeat:1/0,duration:1.5},className:"w-2.5 h-2.5 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.5)]"}),e.jsx("span",{className:"text-white font-mono text-xs font-medium min-w-[35px]",children:T(r)})]})]}),e.jsx("div",{className:"flex-1 px-1",children:e.jsx("div",{className:"h-4 flex items-center gap-[1px] overflow-hidden justify-center max-w-[80px] mx-auto opacity-30",children:d.map((p,x)=>e.jsx(f.div,{animate:{height:`${Math.min(100,Math.max(20,p/255*100))}%`},transition:{type:"spring",stiffness:300,damping:20},className:"w-1 bg-red-500/80 rounded-full"},x))})}),e.jsx("div",{className:"flex items-center",children:e.jsx(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:b,className:"w-9 h-9 bg-indigo-600 rounded-full flex items-center justify-center text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-500 transition-colors flex-shrink-0",children:e.jsx(re,{className:"w-4 h-4 fill-current ml-0.5"})})})]})}function Tt({audioUrl:a,duration:n}){const[r,w]=s.useState(!1),[d,g]=s.useState(n||0),[h,C]=s.useState(0),[y,k]=s.useState(1),[t,c]=s.useState(!1),[l,v]=s.useState(!1),b=s.useRef(null);s.useRef(null);const S=s.useRef(n||0),T=35,p=s.useMemo(()=>Array.from({length:T},()=>Math.floor(Math.random()*60)+20),[]);s.useEffect(()=>{n&&n>0&&(g(n),S.current=n)},[n]),s.useEffect(()=>{const o=b.current;if(!o)return;const m=()=>C(o.currentTime),j=()=>{o.duration&&!isNaN(o.duration)&&o.duration!==1/0&&(g(o.duration),S.current=o.duration)};return o.addEventListener("timeupdate",m),o.addEventListener("loadedmetadata",j),o.addEventListener("durationchange",j),o.addEventListener("play",()=>w(!0)),o.addEventListener("pause",()=>w(!1)),o.addEventListener("ended",()=>{w(!1),C(0),o.currentTime=0}),o.muted=l,()=>{o.removeEventListener("timeupdate",m),o.removeEventListener("loadedmetadata",j),o.removeEventListener("durationchange",j)}},[a,l]);const x=async o=>{o==null||o.stopPropagation(),b.current&&(r?b.current.pause():await b.current.play())},u=o=>{if(o.stopPropagation(),!b.current||!S.current)return;const m=o.currentTarget.getBoundingClientRect(),j=o.clientX-m.left,z=Math.min(Math.max(0,j/m.width),1)*S.current;b.current.currentTime=z,C(z)},U=o=>{if(o.stopPropagation(),!b.current)return;const m=[1,1.5,2],j=m[(m.indexOf(y)+1)%m.length];k(j),b.current.playbackRate=j},$=o=>{const m=Math.floor(o/60),j=Math.floor(o%60);return`${m}:${j.toString().padStart(2,"0")}`},_=S.current>0?h/S.current*100:0;return e.jsxs("div",{className:"flex items-center gap-3 w-full py-1 group/player select-none",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[e.jsx(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:x,className:M("w-10 h-10 rounded-full flex items-center justify-center transition-all bg-white/10 hover:bg-white/20 text-white border border-white/10 shadow-lg",r&&"bg-indigo-500 hover:bg-indigo-600 border-indigo-400"),children:r?e.jsx(bt,{className:"w-5 h-5 fill-current"}):e.jsx(gt,{className:"w-5 h-5 fill-current ml-0.5"})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[e.jsxs("div",{className:"h-10 flex items-center gap-[3px] cursor-pointer group/wave relative",onClick:u,children:[p.map((o,m)=>{const j=m/T*100,R=_>j;return e.jsx(f.div,{initial:!1,animate:{height:`${o}%`,backgroundColor:R?"#818cf8":"rgba(255,255,255,0.15)"},transition:{type:"spring",stiffness:300,damping:20},className:M("flex-1 rounded-full min-h-[4px] transition-shadow duration-300",R&&"shadow-[0_0_8px_rgba(129,140,248,0.5)]")},m)}),e.jsx("div",{className:"absolute inset-0 z-10 opacity-0 group-hover/wave:opacity-100 bg-gradient-to-r from-transparent via-white/5 to-transparent pointer-events-none transition-opacity duration-300"})]}),e.jsxs("div",{className:"flex justify-between items-center px-0.5 opacity-60 group-hover/player:opacity-100 transition-opacity",children:[e.jsxs("div",{className:"text-[10px] font-mono font-medium text-white/70 flex gap-1",children:[e.jsx("span",{className:"text-white font-bold",children:$(h)}),e.jsxs("span",{children:["/ ",$(d)]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>{const o=!l;v(o),b.current&&(b.current.muted=o)},className:"p-1 rounded-md bg-white/5 hover:bg-white/10 text-white/70 hover:text-white border border-white/5 transition-all",title:l?"ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª":"ÙƒØªÙ… Ø§Ù„ØµÙˆØª",children:l?e.jsx(Ke,{className:"w-3 h-3"}):e.jsx(Xe,{className:"w-3 h-3"})}),e.jsxs("button",{onClick:U,className:M("text-[10px] font-bold px-1.5 py-0.5 rounded-md transition-all border",y===1?"bg-white/5 text-white/40 border-white/5":"bg-indigo-500 text-white border-indigo-400"),children:[y,"x"]})]})]})]}),e.jsx("audio",{ref:b,src:a,hidden:!0})]})}function Rt({repliedMessage:a,onCancel:n}){const r=()=>{var w,d,g;return(w=a.fileType)!=null&&w.startsWith("audio/")?"ðŸŽ¤":(d=a.fileType)!=null&&d.startsWith("image/")?"ðŸ“· Photo":(g=a.fileType)!=null&&g.startsWith("video/")?"ðŸŽ¥ Video":a.fileType?"ðŸ“Ž File":a.text};return e.jsx(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"bg-slate-800/60 backdrop-blur-md border border-white/10 border-l-4 border-l-indigo-500 px-3 py-2 mb-2 rounded-r-lg shadow-lg relative",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Te,{className:"w-3 h-3 text-indigo-400"}),e.jsx("span",{className:"text-indigo-400 text-xs font-bold",children:a.senderName})]}),e.jsx("p",{className:"text-slate-300 text-sm truncate opacity-90",children:r()})]}),e.jsx("button",{onClick:n,className:"p-1 text-slate-400 hover:text-white hover:bg-white/10 rounded-full transition-colors flex-shrink-0",children:e.jsx(H,{className:"w-4 h-4"})})]})})}function _t({url:a,type:n,name:r,onClose:w}){const d=n.startsWith("image/"),g=n.startsWith("video/"),h=n.includes("pdf");return e.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex flex-col items-center justify-center animate-in fade-in duration-200",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-white font-medium truncate max-w-[200px] sm:max-w-md",children:r}),e.jsx("p",{className:"text-gray-400 text-xs",children:n})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:a,download:r,className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(Ce,{className:"w-6 h-6"})}),e.jsx("button",{onClick:w,className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(H,{className:"w-7 h-7"})})]})]}),e.jsx("div",{className:"w-full h-full flex items-center justify-center p-4 sm:p-10",children:d?e.jsx("img",{src:a,alt:r,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl animate-in zoom-in-95 duration-300"}):g?e.jsx("video",{src:a,controls:!0,autoPlay:!0,className:"max-w-full max-h-full rounded-lg shadow-2xl"}):h?e.jsx("iframe",{src:a,className:"w-full h-full max-w-5xl bg-white rounded-lg shadow-2xl",title:r}):e.jsxs("div",{className:"bg-[#202c33] p-8 rounded-2xl flex flex-col items-center gap-6 max-w-sm text-center shadow-2xl border border-gray-800",children:[e.jsx("div",{className:"w-20 h-20 bg-[#00a884]/20 rounded-full flex items-center justify-center",children:e.jsx(nt,{className:"w-10 h-10 text-[#00a884]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white text-xl font-bold mb-2",children:"No Preview Available"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["This file type (",n,") cannot be previewed directly. You can download it to view."]})]}),e.jsx("a",{href:a,download:r,className:"w-full",children:e.jsx(Y,{className:"w-full bg-[#00a884] hover:bg-[#00956f] text-white py-6 text-lg",children:"Download File"})})]})})]})}function Pt({partnerId:a,partnerName:n,partnerAvatar:r,isGroup:w,onClose:d,messages:g,onOpenGallery:h,onAudioCall:C,onVideoCall:y,onShowProfile:k,language:t,t:c}){const[l,v]=s.useState(null),[b,S]=s.useState(!0),T=g.filter(p=>{var x,u;return p.fileUrl&&(((x=p.fileType)==null?void 0:x.startsWith("image/"))||((u=p.fileType)==null?void 0:u.startsWith("video/")))});return s.useEffect(()=>{async function p(){if(w){const{data:x,error:u}=await pe.from("groups").select("*").eq("id",a).single();x&&v(x),S(!1)}else{const{data:x,error:u}=await pe.from("profiles").select("*").eq("id",a).single();x&&v(x),S(!1)}}p()},[a,w]),e.jsxs(f.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"absolute top-0 right-0 h-full w-full md:w-[380px] bg-slate-900/95 backdrop-blur-xl border-l border-white/10 z-[100] shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-white/5 bg-slate-900/50",children:[e.jsx("button",{onClick:d,className:"p-2 -ml-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-colors",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("h2",{className:`text-lg font-semibold text-white ${t==="ar"?"font-arabic":""}`,children:t==="ar"?"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„":"Contact Info"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-8 custom-scrollbar",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"relative mb-4 group cursor-pointer",children:[e.jsxs(we,{className:"w-32 h-32 border-4 border-slate-800 shadow-2xl group-hover:border-indigo-500/50 transition-colors duration-300",children:[e.jsx(ge,{src:r||(l==null?void 0:l.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(n)}&background=random&color=fff`}),e.jsx(ve,{className:"bg-slate-800 text-3xl font-bold text-indigo-400",children:n.charAt(0).toUpperCase()})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ne,{className:"w-8 h-8 text-white/80"})})]}),e.jsx("h3",{className:"text-2xl font-bold text-white text-center mb-1",children:n}),e.jsx("p",{className:"text-indigo-400 text-sm font-medium",children:l!=null&&l.username?`@${l.username}`:w?t==="ar"?"Ø¯Ø±Ø¯Ø´Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©":"Group Chat":t==="ar"?"~Ù…Ø³ØªØ®Ø¯Ù…":"~User"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-8",children:[e.jsxs("button",{onClick:C,className:"flex flex-col items-center gap-2 p-3 rounded-xl bg-slate-800/50 hover:bg-slate-800 border border-white/5 transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/10 flex items-center justify-center group-hover:bg-indigo-500/20 text-indigo-400 transition-colors",children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:t==="ar"?"ØµÙˆØª":"Audio"})]}),e.jsxs("button",{onClick:y,className:"flex flex-col items-center gap-2 p-3 rounded-xl bg-slate-800/50 hover:bg-slate-800 border border-white/5 transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-violet-500/10 flex items-center justify-center group-hover:bg-violet-500/20 text-violet-400 transition-colors",children:e.jsx(G,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:t==="ar"?"ÙÙŠØ¯ÙŠÙˆ":"Video"})]}),e.jsxs("button",{onClick:k,className:"flex flex-col items-center gap-2 p-3 rounded-xl bg-slate-800/50 hover:bg-slate-800 border border-white/5 transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center group-hover:bg-emerald-500/20 text-emerald-400 transition-colors",children:e.jsx(ae,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:t==="ar"?"Ø§Ù„Ù…Ù„Ù":"Profile"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-800/30 rounded-xl p-4 border border-white/5",children:[e.jsx("p",{className:`text-slate-500 text-[10px] uppercase tracking-widest font-black mb-4 ${t==="ar"?"font-arabic":""}`,children:t==="ar"?"Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©":"Personal Info"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400 shrink-0",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-slate-100 text-[15px] leading-relaxed break-words",children:(l==null?void 0:l.about)||(t==="ar"?"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø¨Ø°Ø© Ø´Ø®ØµÙŠØ©":"No bio provided")}),e.jsx("p",{className:`text-slate-500 text-[10px] uppercase tracking-wider mt-1 font-bold ${t==="ar"?"font-arabic":""}`,children:c("about")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-violet-500/10 flex items-center justify-center text-violet-400",children:e.jsx(ae,{className:"w-3.5 h-3.5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 text-sm font-medium",children:(l==null?void 0:l.gender)==="male"?c("male"):(l==null?void 0:l.gender)==="female"?c("female"):t==="ar"?"ØºÙŠØ± Ù…Ø­Ø¯Ø¯":"Not specified"}),e.jsx("p",{className:`text-slate-600 text-[9px] uppercase font-bold ${t==="ar"?"font-arabic":""}`,children:c("gender")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-400",children:e.jsx(be,{className:"w-3.5 h-3.5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 text-sm font-medium",children:(l==null?void 0:l.birth_year)||"----"}),e.jsx("p",{className:`text-slate-600 text-[9px] uppercase font-bold ${t==="ar"?"font-arabic":""}`,children:c("birth_year")})]})]})]}),e.jsx("div",{className:"h-px bg-white/5 my-2"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-500/10 flex items-center justify-center text-slate-400 shrink-0",children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-slate-300 text-sm truncate",children:(l==null?void 0:l.email)||(w?t==="ar"?"Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©":"Group Conversation":t==="ar"?"Ù…Ø®ÙÙŠ":"Hidden")}),e.jsx("p",{className:`text-slate-600 text-[10px] uppercase mt-0.5 font-bold ${t==="ar"?"font-arabic":""}`,children:t==="ar"?"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ":"Email"})]})]}),(l==null?void 0:l.created_at)&&e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-500/10 flex items-center justify-center text-slate-400 shrink-0",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-slate-300 text-sm",children:new Date(l.created_at).toLocaleDateString(t==="ar"?"ar-EG":"en-US")}),e.jsx("p",{className:`text-slate-600 text-[10px] uppercase mt-0.5 font-bold ${t==="ar"?"font-arabic":""}`,children:t==="ar"?"Ø§Ù†Ø¶Ù… ÙÙŠ":"Joined"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800/30 rounded-xl p-4 border border-white/5 hover:bg-slate-800/50 transition-colors cursor-pointer group",onClick:h,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-slate-500 text-xs uppercase tracking-widest font-bold",children:t==="ar"?"Ø§Ù„ÙˆØ³Ø§Ø¦Ø· ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª":"Media, Links & Docs"}),e.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1 group-hover:text-indigo-400 transition-colors",children:[T.length," ",e.jsx("span",{className:"opacity-50",children:"â€º"})]})]}),T.length>0?e.jsx("div",{className:"grid grid-cols-4 gap-2",children:T.slice(0,4).map((p,x)=>{var u;return e.jsxs("div",{className:"aspect-square rounded-lg bg-slate-800 border border-white/5 overflow-hidden relative group/img",children:[(u=p.fileType)!=null&&u.startsWith("image")?e.jsx("img",{src:p.fileUrl,alt:"Media",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800",children:e.jsx(G,{className:"w-5 h-5 text-slate-400"})}),e.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover/img:bg-transparent transition-colors"})]},p.id||x)})}):e.jsx("p",{className:"text-slate-600 text-xs italic py-2",children:t==="ar"?"Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ³Ø§Ø¦Ø· Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ø¹Ø¯.":"No shared media yet."})]}),w&&(l==null?void 0:l.group_id)&&e.jsx("div",{className:"bg-slate-800/30 rounded-xl p-4 border border-white/5 hover:bg-slate-800/50 transition-colors cursor-pointer group",onClick:()=>{const p=`${window.location.origin}?join=${l.group_id}`;if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(p).then(()=>O.success(t==="ar"?"ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ©!":"Invite link copied!",{description:t==="ar"?"Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.":"Share this link to invite others."})).catch(()=>O.error(t==="ar"?"ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·":"Failed to copy link"));else try{const x=document.createElement("textarea");x.value=p,document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x),O.success(t==="ar"?"ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ©!":"Invite link copied!",{description:t==="ar"?"Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.":"Share this link to invite others."})}catch{O.error(t==="ar"?"ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙØ¸Ø©":"Clipboard access denied",{description:t==="ar"?"ÙŠØ±Ø¬Ù‰ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ§Ù‹.":"Please manually copy the link."})}},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/10 flex items-center justify-center group-hover:bg-indigo-500/20 text-indigo-400 transition-colors",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-slate-300 text-sm group-hover:text-white transition-colors",children:t==="ar"?"Ø¯Ø¹ÙˆØ© Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø·":"Invite to Group via Link"}),e.jsx("p",{className:"text-slate-500 text-xs",children:t==="ar"?"Ø§Ø¶ØºØ· Ù„Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ©":"Tap to copy invite link"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{className:"w-full flex items-center gap-4 p-4 rounded-xl hover:bg-slate-800/50 transition-colors text-left group",children:[e.jsx(Je,{className:"w-5 h-5 text-slate-400 group-hover:text-white transition-colors"}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-slate-300 text-sm group-hover:text-white",children:t==="ar"?"ÙƒØªÙ… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª":"Mute Notifications"})})]}),e.jsxs("button",{className:"w-full flex items-center gap-4 p-4 rounded-xl hover:bg-slate-800/50 transition-colors text-left group",children:[e.jsx(yt,{className:"w-5 h-5 text-slate-400 group-hover:text-yellow-400 transition-colors"}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-slate-300 text-sm group-hover:text-white",children:t==="ar"?"Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ø¨Ù†Ø¬Ù…Ø©":"Starred Messages"})})]}),e.jsx("div",{className:"h-px bg-white/5 my-2"}),e.jsxs("button",{className:"w-full flex items-center gap-4 p-4 rounded-xl hover:bg-red-500/10 transition-colors text-left group text-red-400",children:[e.jsx(tt,{className:"w-5 h-5"}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-sm font-medium",children:t==="ar"?`Ø­Ø¸Ø± ${n}`:`Block ${n}`})})]}),e.jsxs("button",{className:"w-full flex items-center gap-4 p-4 rounded-xl hover:bg-red-500/10 transition-colors text-left group text-red-400",children:[e.jsx(xt,{className:"w-5 h-5"}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-sm font-medium",children:t==="ar"?"Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„":"Report Contact"})})]})]})]})]})]})}function Lt({messages:a,onClose:n}){const[r,w]=s.useState("media"),[d,g]=s.useState(null),{media:h,docs:C,links:y}=s.useMemo(()=>{const t=[],c=[],l=[];return a.forEach(v=>{var T,p,x;v.fileUrl&&((T=v.fileType)!=null&&T.startsWith("image/")||(p=v.fileType)!=null&&p.startsWith("video/"))?t.push(v):v.fileUrl&&c.push(v);const b=/(https?:\/\/[^\s]+)/g,S=(x=v.text)==null?void 0:x.match(b);S&&S.forEach(u=>{l.push({...v,linkUrl:u})})}),{media:t.reverse(),docs:c.reverse(),links:l.reverse()}},[a]),k=[{id:"media",label:"Media"},{id:"docs",label:"Docs"},{id:"links",label:"Links"}];return e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute inset-0 z-[150] bg-slate-950 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-900 border-b border-white/5",children:[e.jsx("button",{onClick:n,className:"p-2 -ml-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-colors",children:e.jsx(le,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Media, Links & Docs"})]}),e.jsx("div",{className:"flex border-b border-white/5 bg-slate-900/50",children:k.map(t=>e.jsxs("button",{onClick:()=>w(t.id),className:M("flex-1 py-3 text-sm font-medium relative transition-colors",r===t.id?"text-indigo-400":"text-slate-400 hover:text-slate-300"),children:[t.label,r===t.id&&e.jsx(f.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-500"})]},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-950 p-4 custom-scrollbar",children:[r==="media"&&e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-5 gap-2",children:h.length>0?h.map(t=>{var c;return e.jsx("div",{className:"aspect-square relative group overflow-hidden rounded-lg bg-slate-900 border border-white/5",children:(c=t.fileType)!=null&&c.startsWith("image/")?e.jsx("img",{src:t.fileUrl,alt:t.fileName,className:"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform duration-300",onClick:()=>g(t.fileUrl)}):e.jsx("div",{className:"w-full h-full flex items-center justify-center cursor-pointer hover:bg-slate-800",children:e.jsx(G,{className:"w-8 h-8 text-slate-400"})})},t.id)}):e.jsxs("div",{className:"col-span-full py-20 text-center text-slate-500",children:[e.jsx(Ne,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No media shared"})]})}),r==="docs"&&e.jsx("div",{className:"space-y-2",children:C.length>0?C.map(t=>{var c;return e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-slate-900/50 border border-white/5 hover:bg-slate-800 transition-colors group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-200 truncate",children:t.fileName}),e.jsxs("p",{className:"text-xs text-slate-500 uppercase",children:[((c=t.fileType)==null?void 0:c.split("/")[1])||"FILE"," â€¢ ",new Date(t.timestamp).toLocaleDateString()]})]}),e.jsx("a",{href:t.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-slate-500 hover:text-white rounded-full hover:bg-white/10 opacity-0 group-hover:opacity-100 transition-all",children:e.jsx(Ce,{className:"w-4 h-4"})})]},t.id)}):e.jsxs("div",{className:"py-20 text-center text-slate-500",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No documents found"})]})}),r==="links"&&e.jsx("div",{className:"space-y-2",children:y.length>0?y.map((t,c)=>e.jsxs("div",{className:"flex gap-4 p-3 rounded-xl bg-slate-900/50 border border-white/5 hover:bg-slate-800 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-400 flex-shrink-0",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("a",{href:t.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:underline text-sm font-medium truncate block",children:t.linkUrl}),t.text!==t.linkUrl&&e.jsx("p",{className:"text-xs text-slate-400 truncate mt-0.5",children:t.text}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:new Date(t.timestamp).toLocaleDateString()})]})]},c)):e.jsxs("div",{className:"py-20 text-center text-slate-500",children:[e.jsx(Z,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No links shared"})]})})]}),e.jsx(A,{children:d&&e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-black/95 backdrop-blur-md flex items-center justify-center p-4",onClick:()=>g(null),children:[e.jsx("button",{className:"absolute top-4 right-4 p-2 bg-white/10 rounded-full text-white hover:bg-white/20 transition-colors",onClick:()=>g(null),children:e.jsx(H,{className:"w-6 h-6"})}),e.jsx(f.img,{initial:{scale:.9},animate:{scale:1},src:d||"",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:t=>t.stopPropagation()})]})})]})}function $t({onClose:a,onSend:n}){const[r,w]=s.useState(""),[d,g]=s.useState(["",""]),h=()=>{d.length<10&&g([...d,""])},C=(t,c)=>{const l=[...d];l[t]=c,g(l)},y=t=>{d.length>2&&g(d.filter((c,l)=>l!==t))},k=()=>{const t=d.filter(c=>c.trim()!=="");r.trim()&&t.length>=2&&(n(r,t),a())};return e.jsx(f.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-3xl w-full max-w-md shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-gradient-to-r from-indigo-500/10 to-violet-500/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl text-indigo-400",children:e.jsx(Se,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white leading-none",children:"Create Poll"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ask your friends anything"})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-white/10 rounded-full transition-all",children:e.jsx(H,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4 text-indigo-400"}),"Question"]}),e.jsx(fe,{value:r,onChange:t=>w(t.target.value),placeholder:"What's on your mind?",dir:"auto",className:"bg-slate-950 border-white/5 focus:border-indigo-500/50 h-12 text-white placeholder:text-slate-600 rounded-xl px-4"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Options"}),d.map((t,c)=>e.jsx(f.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-2 group",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(fe,{value:t,onChange:l=>C(c,l.target.value),placeholder:`Option ${c+1}`,dir:"auto",className:"bg-slate-950/50 border-white/5 focus:border-indigo-500/50 h-11 text-white placeholder:text-slate-700 rounded-xl px-4"}),c>=2&&e.jsx("button",{onClick:()=>y(c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-600 hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(H,{className:"w-4 h-4"})})]})},c)),d.length<10&&e.jsxs("button",{onClick:h,className:"w-full py-3 border-2 border-dashed border-slate-800 rounded-xl text-slate-500 hover:text-indigo-400 hover:border-indigo-500/30 transition-all flex items-center justify-center gap-2 text-sm font-medium",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Add Option"]})]})]}),e.jsxs("div",{className:"p-6 bg-slate-950/50 flex gap-3",children:[e.jsx(Y,{variant:"ghost",onClick:a,className:"flex-1 text-slate-400 hover:text-white hover:bg-white/5 h-12 rounded-xl font-bold",children:"Cancel"}),e.jsxs(Y,{onClick:k,disabled:!r.trim()||d.filter(t=>t.trim()).length<2,className:"flex-1 bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 text-white shadow-lg shadow-indigo-500/20 h-12 rounded-xl font-bold gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Create Poll"]})]})]})})}const Dt=s.memo(({question:a,options:n,votes:r,currentUserId:w,onVote:d,isSent:g})=>{const h=Object.keys(r).length,C=r[w],y=k=>{const t=Object.values(r).filter(l=>l===k).length,c=h===0?0:t/h*100;return{count:t,percent:c}};return e.jsxs("div",{className:"flex flex-col gap-4 min-w-[240px] max-w-sm",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-xl",children:e.jsx(Ze,{className:"w-5 h-5 text-indigo-400"})}),e.jsx("h3",{className:"text-lg font-bold text-white leading-tight",dir:"auto",children:a})]}),e.jsx("div",{className:"space-y-2",children:n.map((k,t)=>{const{count:c,percent:l}=y(t),v=C===t,b=/[\u0600-\u06FF]/.test(k);return e.jsxs("button",{onClick:()=>d(t),className:"w-full text-left group relative outline-none",dir:b?"rtl":"ltr",children:[e.jsxs("div",{className:M("relative z-10 flex items-center justify-between p-3 rounded-xl border transition-all duration-300",v?"bg-indigo-600/30 border-indigo-500/50 shadow-lg shadow-indigo-500/10":"bg-white/5 border-white/5 hover:border-white/10"),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:M("w-5 h-5 rounded-full border flex items-center justify-center transition-colors",v?"bg-white border-white":"border-white/20 group-hover:border-white/40"),children:v&&e.jsx(oe,{className:"w-3 h-3 text-indigo-600 stroke-[4px]"})}),e.jsx("span",{className:M("font-medium truncate",v?"text-white":"text-slate-200"),dir:"auto",children:k})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2",children:e.jsx("span",{className:"text-xs font-bold text-slate-400",children:c})})]}),e.jsx("div",{className:"absolute inset-0 rounded-xl overflow-hidden pointer-events-none",children:e.jsx(f.div,{initial:{width:0},animate:{width:`${l}%`},transition:{type:"spring",stiffness:100,damping:20},className:M("h-full opacity-10 transition-colors",v?"bg-white":"bg-indigo-400")})})]},t)})}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider",children:[h," ",h===1?"Vote":"Votes"]}),e.jsx("span",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider",children:C!==void 0?"Voted":"Not voted"})]})]})}),Et=s.memo(({message:a,currentUserId:n,partnerName:r,isGroup:w,isSequential:d,isMenuOpen:g,onToggleMenu:h,onReact:C,onReply:y,onDelete:k,onEdit:t,onVote:c,setViewingFile:l,repliedMessage:v,language:b,t:S,formatMessageTime:T,renderFilePreview:p,onJoinGroup:x})=>{var _,o;const u=a.senderId===n,U=b==="ar",$=u&&!U||!u&&U;return e.jsx("div",{id:`msg-${a.id}`,className:M("flex w-full mb-4",u?"justify-end":"justify-start",g&&"z-[130] relative"),children:e.jsxs("div",{className:M("relative max-w-[80%] group",u?"items-end":"items-start"),children:[w&&!u&&!d&&e.jsx("p",{className:"text-[10px] font-bold mb-1 text-indigo-400 ml-1",children:"~User"}),e.jsx("div",{className:M("absolute top-0 z-[110] transition-opacity",$?"left-0 -translate-x-full pr-1 opacity-100":"right-0 translate-x-full pl-1 opacity-100"),children:e.jsx("button",{onClick:m=>{m.stopPropagation(),h(a.id)},className:M("p-1 rounded-full transition-all bg-slate-900/50 backdrop-blur-sm shadow-sm border border-white/5",g?"text-indigo-400 bg-slate-800":"text-slate-400 hover:text-white"),children:e.jsx(ke,{className:"w-3.5 h-3.5"})})}),e.jsxs("div",{onClick:()=>{window.innerWidth<1024&&h(a.id)},className:M("rounded-2xl px-4 py-2 shadow-sm relative transition-all duration-200 cursor-pointer active:opacity-90 select-none",u?"bg-gradient-to-br from-indigo-600 to-violet-600 text-white rounded-br-none":"bg-slate-800/80 backdrop-blur-sm text-slate-100 border border-white/5 rounded-bl-none",g&&"ring-2 ring-indigo-500 ring-offset-2 ring-offset-slate-900"),children:[a.replyToId&&v&&e.jsxs("div",{onClick:m=>{m.stopPropagation();const j=document.getElementById(`msg-${v.id}`);j&&(j.scrollIntoView({behavior:"smooth",block:"center"}),j.classList.add("ring-2","ring-yellow-400","ring-offset-2"),setTimeout(()=>{j.classList.remove("ring-2","ring-yellow-400","ring-offset-2")},2e3))},className:M("mb-2 p-2 rounded-lg border-l-4 cursor-pointer hover:bg-white/5 transition-colors",u?"bg-white/10 border-white/30":"bg-slate-700/50 border-indigo-400"),children:[e.jsx("p",{className:"text-[10px] font-semibold mb-0.5 opacity-80",children:v.senderId===n?b==="ar"?"Ø£Ù†Øª":"You":r}),e.jsx("p",{className:"text-xs opacity-70 line-clamp-2",children:v.text||((_=v.fileType)!=null&&_.startsWith("image/")?b==="ar"?"ðŸ“· ØµÙˆØ±Ø©":"ðŸ“· Photo":b==="ar"?"ðŸ“Ž Ù…Ù„Ù":"ðŸ“Ž File")})]}),p(a,u),a.poll?e.jsx(Dt,{question:a.poll.question,options:a.poll.options,votes:a.poll.votes,onVote:m=>c(a.id,m),currentUserId:n,isSent:u}):!(((o=a.fileType)!=null&&o.startsWith("audio/")||a.fileType==="audio")&&(a.text==="ðŸŽ¤"||a.text==="ðŸŽ¤ Voice Message"||a.text==="Voice Message"))&&e.jsx("p",{className:"text-[15px] leading-relaxed break-words whitespace-pre-wrap",children:a.text.split(/(\bhttps?:\/\/[^\s]+)/g).map((m,j)=>{if(m.match(/^https?:\/\//)){try{const R=new URL(m);if(R.searchParams.has("join"))return e.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 font-bold underline decoration-indigo-400 decoration-2 text-indigo-300 hover:text-white transition-colors bg-indigo-500/10 px-1 rounded mx-0.5",onClick:z=>{if(z.preventDefault(),x){const E=R.searchParams.get("join");E&&x(E)}},children:[e.jsx(Z,{className:"w-3 h-3"}),"Join Group"]},j)}catch{}return e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-400 hover:text-blue-300 break-all",children:m},j)}return m})}),e.jsxs("div",{className:M("flex items-center gap-1.5 mt-1 opacity-60 text-[10px]",u?"justify-end":"justify-start"),children:[e.jsx("span",{children:T(a.timestamp)}),u&&(a.isRead?e.jsx(it,{className:"w-3 h-3 text-sky-400"}):e.jsx(oe,{className:"w-3 h-3"}))]}),a.reactions&&Object.keys(a.reactions).length>0&&e.jsx("div",{className:M("absolute -bottom-3 flex flex-wrap gap-1 z-10",u?"right-2":"left-2"),children:Object.entries(a.reactions).map(([m,j])=>e.jsxs(f.button,{initial:{scale:0},animate:{scale:1},onClick:R=>{R.stopPropagation(),C(a.id,m)},className:M("bg-slate-900/90 backdrop-blur-md border border-white/10 rounded-full px-1.5 py-0.5 text-[10px] flex items-center gap-1 shadow-lg",j.includes(n)&&"border-indigo-500/50 bg-indigo-500/10"),children:[e.jsx("span",{children:m}),j.length>1&&e.jsx("span",{className:"opacity-70 font-bold",children:j.length})]},m))})]}),e.jsx(A,{children:g&&e.jsx("div",{className:M("absolute top-8 z-[120]",$?"right-0":"left-0"),children:e.jsxs(f.div,{initial:{opacity:0,scale:.9,x:$?20:-20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.9,x:$?10:-10},className:"bg-slate-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl py-1.5 min-w-[120px] overflow-hidden",children:[e.jsx("div",{className:"flex px-1.5 pb-1.5 mb-1.5 border-b border-white/5 overflow-x-auto scrollbar-hide gap-1",children:["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ”¥"].map(m=>e.jsx("button",{onClick:()=>{C(a.id,m),h()},className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors text-lg",children:m},m))}),e.jsxs("button",{onClick:()=>{y(a),h()},className:"w-full text-left px-4 py-2 text-xs text-slate-300 hover:bg-white/5 flex items-center gap-2",children:[e.jsx(Te,{className:"w-3.5 h-3.5"})," ",S("reply")]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{t(a.id,a.text),h()},className:"w-full text-left px-4 py-2 text-xs text-slate-300 hover:bg-white/5 flex items-center gap-2",children:[e.jsx(Me,{className:"w-3.5 h-3.5"})," ",S("edit")]}),e.jsxs("button",{onClick:()=>{k(a.id),h()},className:"w-full text-left px-4 py-2 text-xs text-red-400 hover:bg-red-500/10 flex items-center gap-2",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," ",S("delete")]})]})]})})})]})})}),Ft=s.memo(({onSendMessage:a,currentUserId:n,replyTo:r,setReplyTo:w,onTyping:d,t:g,language:h,onSendVoiceMessage:C,editingMessage:y,setEditingMessage:k,onEditMessage:t,scrollToBottom:c,isGroup:l,setShowPollCreator:v})=>{const[b,S]=s.useState(""),[T,p]=s.useState(null),[x,u]=s.useState(!1),[U,$]=s.useState(!1),[_,o]=s.useState(null),[m,j]=s.useState(!1),R=s.useRef(null),z=s.useRef(null),E=s.useRef(!1),F=s.useRef(null);s.useEffect(()=>{var N;y&&(S(y.text),(N=R.current)==null||N.focus())},[y]),s.useEffect(()=>{b.length>0?(E.current||(E.current=!0,d(!0)),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{E.current=!1,d(!1)},3e3)):E.current&&(E.current=!1,d(!1))},[b.length===0,b.length>0]);const q=async N=>{if(N==null||N.preventDefault(),T){u(!0);try{const L=new FormData;L.append("file",T),L.append("userId",n);const V=await(await fetch(`https://${Ie}.supabase.co/functions/v1/make-server-f2fe46ac/upload`,{method:"POST",headers:{Authorization:`Bearer ${Oe}`},body:L})).json();if(V.error)throw new Error(V.error);a(b.trim(),V.fileUrl,V.fileType,V.fileName,r==null?void 0:r.id,_),S(""),p(null),w(null),setTimeout(()=>c(),100)}catch(L){O.error("Upload failed: "+L.message)}finally{u(!1)}}else b.trim()&&(y&&t?(t(y.id,b.trim()),k(null)):a(b.trim(),void 0,void 0,void 0,r==null?void 0:r.id,_),S(""),w(null),o(null),setTimeout(()=>c(),100))};return s.useLayoutEffect(()=>{R.current&&(R.current.style.height="auto",R.current.style.height=`${Math.min(R.current.scrollHeight,120)}px`)},[b]),e.jsxs("div",{className:"p-4 bg-slate-900/80 backdrop-blur-md border-t border-white/5 relative z-50",children:[e.jsxs(A,{children:[r&&e.jsx(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mb-3",children:e.jsx(Rt,{repliedMessage:r,onCancel:()=>w(null)})}),y&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mb-3 p-3 bg-indigo-500/10 border-l-4 border-indigo-500 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-400",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:g("editing_message")})]}),e.jsx("button",{onClick:()=>{k(null),S("")},className:"text-slate-400 hover:text-white",children:e.jsx(H,{className:"w-4 h-4"})})]}),T&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-2 flex items-center gap-3 bg-slate-800/80 rounded-xl p-3 border border-indigo-500/30",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg",children:e.jsx(J,{className:"w-5 h-5 text-indigo-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:T.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[(T.size/1024/1024).toFixed(2)," MB"]})]}),e.jsx("button",{onClick:()=>p(null),className:"p-1 hover:bg-white/10 rounded-full",children:e.jsx(H,{className:"w-4 h-4 text-slate-400"})})]})]}),e.jsxs("div",{className:"flex items-end gap-3 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex-1 bg-slate-800/50 backdrop-blur-sm rounded-2xl flex items-end p-1 border border-white/10 shadow-lg focus-within:border-indigo-500/50 focus-within:ring-1 focus-within:ring-indigo-500/20 transition-all",children:U?e.jsx(Mt,{onSend:(N,L)=>{C(N,L),$(!1)},onCancel:()=>$(!1)}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center self-center px-1",children:[e.jsx("input",{type:"file",ref:z,onChange:N=>{var L;return p(((L=N.target.files)==null?void 0:L[0])||null)},className:"hidden"}),e.jsx("button",{onClick:()=>{var N;return(N=z.current)==null?void 0:N.click()},className:"p-2.5 text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-xl transition-all",children:e.jsx(pt,{className:"w-5 h-5"})}),l&&e.jsx("button",{onClick:()=>v(!0),className:"p-2.5 text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-xl transition-all",children:e.jsx(Se,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsxs(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>j(!m),className:M("p-2.5 rounded-xl transition-all flex items-center justify-center relative",_?"text-orange-400 bg-orange-500/20":"text-slate-400 hover:text-white"),children:[e.jsx(Ct,{className:M("w-5 h-5",_&&"animate-pulse")}),_&&e.jsxs("span",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:[_,"s"]})]}),e.jsx(A,{children:m&&e.jsx(f.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.9},className:"absolute bottom-full left-0 mb-4 bg-slate-900 border border-white/20 rounded-2xl p-2 shadow-2xl z-[200] min-w-[160px] backdrop-blur-2xl",children:e.jsx("div",{className:"flex flex-col gap-1",children:[{label:h==="ar"?"Ø¥ÙŠÙ‚Ø§Ù":"Off",value:null},{label:h==="ar"?"5 Ø«ÙˆØ§Ù†Ù":"5 Seconds",value:5},{label:h==="ar"?"10 Ø«ÙˆØ§Ù†Ù":"10 Seconds",value:10},{label:h==="ar"?"30 Ø«Ø§Ù†ÙŠØ©":"30 Seconds",value:30},{label:h==="ar"?"Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©":"1 Minute",value:60},{label:h==="ar"?"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©":"1 Hour",value:3600}].map(N=>e.jsxs("button",{onClick:()=>{o(N.value),j(!1)},className:M("w-full text-left px-4 py-2.5 rounded-xl text-sm transition-all flex items-center justify-between",_===N.value?"bg-indigo-500/20 text-indigo-300 font-bold":"text-slate-300 hover:bg-white/5"),children:[N.label,_===N.value&&e.jsx(oe,{className:"w-4 h-4"})]},N.label))})})})]})]}),e.jsx("textarea",{ref:R,rows:1,placeholder:g("type_message"),value:b,onChange:N=>S(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&!N.shiftKey){if(N.preventDefault(),x)return;q(N)}},className:"flex-1 bg-transparent border-none text-white placeholder:text-slate-500 px-4 py-3 resize-none focus:outline-none max-h-[120px] scrollbar-hide text-[15px] leading-relaxed"})]})}),b.trim()||T?e.jsx(f.button,{whileHover:{scale:1.1,rotate:-10},whileTap:{scale:.9},onClick:q,className:"h-[50px] w-[50px] bg-gradient-to-tr from-indigo-600 to-violet-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-indigo-500/25",children:x?e.jsx(We,{className:"w-5 h-5 animate-spin"}):e.jsx(re,{className:"w-5 h-5 fill-current"})}):e.jsx(f.button,{onClick:()=>$(!0),whileHover:{scale:1.1},whileTap:{scale:.9},className:"h-[50px] w-[50px] bg-slate-800 text-white rounded-2xl flex items-center justify-center shadow-lg hover:bg-slate-700 transition-colors",children:e.jsx(Ye,{className:"w-5 h-5"})})]})]})});function zt({currentUserId:a,partnerId:n,partnerName:r,partnerAvatar:w,messages:d,isPartnerOnline:g,isPartnerTyping:h,onBack:C,onSendMessage:y,onSendVoiceMessage:k,onDeleteMessage:t,onTyping:c,onRefresh:l,onReact:v,onSendPoll:b,onVote:S,onStartCall:T,onEditMessage:p,smartReplies:x=[],isGroup:u,onJoinGroup:U,onShowProfile:$,language:_,t:o}){const[m,j]=s.useState(null),[R,z]=s.useState(null),[E,F]=s.useState(!1),q=s.useRef(null),[N,L]=s.useState(null),[ne,V]=s.useState(null),[ce,de]=s.useState(!1),[ee,_e]=s.useState(!1),[B,te]=s.useState(""),[Pe,W]=s.useState(!1),[Le,xe]=s.useState(!1),[$e,he]=s.useState(!1),X=s.useRef(null),me=s.useRef(!1),se=s.useRef(null),ue=s.useRef(d.length);s.useEffect(()=>{L(null),V(null),j(null),te("")},[n]);const I=(i="auto")=>{var P;X.current&&(me.current=!0,(P=q.current)==null||P.scrollIntoView({behavior:i}),setTimeout(()=>{me.current=!1},500))},De=()=>{if(!X.current)return;const{scrollTop:i,scrollHeight:P,clientHeight:Q}=X.current,K=P-i-Q<200;F(!K)};s.useEffect(()=>{se.current=null;const i=setTimeout(()=>I("auto"),200);return()=>clearTimeout(i)},[n]),s.useEffect(()=>{if(d.length>0){if(se.current!==n){I("auto");const i=setTimeout(()=>I("auto"),100),P=setTimeout(()=>I("auto"),350);return se.current=n,()=>{clearTimeout(i),clearTimeout(P)}}else if(d.length>ue.current){const i=X.current;if(i){const{scrollTop:P,scrollHeight:Q,clientHeight:K}=i;Q-P-K<450&&I("smooth")}}}ue.current=d.length},[d,n]);const Ee=s.useCallback(i=>new Date(i).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),[]),Fe=s.useCallback(i=>{if(!i){L(null);return}L(P=>P===i?null:i)},[]),ze=s.useCallback(i=>{j({id:i.id,senderName:i.senderId===a?_==="ar"?"Ø£Ù†Øª":"You":r,text:i.text,fileType:i.fileType}),L(null)},[a,_,r]),Ue=s.useCallback(i=>{V({id:i.id,text:i.text}),L(null)},[]),Ae=s.useCallback(()=>{I("smooth")},[]),Ve=s.useCallback((i,P)=>{var Q,K;return!i.fileUrl||!i.fileType?null:i.fileType.startsWith("image/")?e.jsx(f.div,{whileHover:{scale:1.02},className:"mb-2 overflow-hidden rounded-lg",children:e.jsx("img",{src:i.fileUrl,alt:i.fileName||"Image",className:"max-w-full max-h-64 object-cover cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>z({url:i.fileUrl,type:i.fileType,name:i.fileName||"Image"})})}):i.fileType.startsWith("video/")?e.jsx("div",{className:"mb-2 rounded-lg overflow-hidden bg-black/20",children:e.jsx("video",{src:i.fileUrl,controls:!0,className:"max-w-full max-h-64"})}):i.fileType.startsWith("audio/")||i.fileType==="audio"||/\.(mp3|wav|ogg|webm|m4a|aac)$/i.test(i.fileName||"")?e.jsx(Tt,{audioUrl:i.fileUrl,duration:((Q=i.fileName)!=null&&Q.includes("duration=")?parseFloat(i.fileName.split("duration=")[1]):void 0)||((K=i.fileUrl)!=null&&K.includes("duration=")?parseFloat(i.fileUrl.split("duration=")[1]):void 0)}):e.jsxs("div",{className:M("flex items-center gap-3 mb-2 p-3 rounded-xl cursor-pointer hover:opacity-80 transition-all border",P?"bg-indigo-900/40 border-indigo-500/30":"bg-slate-800/60 border-white/10"),onClick:()=>z({url:i.fileUrl,type:i.fileType,name:i.fileName||"File"}),children:[e.jsx("div",{className:M("p-2 rounded-lg",P?"bg-indigo-500/20":"bg-slate-700/50"),children:e.jsx(J,{className:M("w-5 h-5",P?"text-indigo-300":"text-slate-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:i.fileName}),e.jsx("p",{className:"text-xs opacity-70 uppercase",children:i.fileType.split("/")[1]||"FILE"})]})]})},[]),He=s.useMemo(()=>{const i=new Map;return d.forEach(P=>i.set(P.id,P)),i},[d]),ie=s.useMemo(()=>B.trim()?d.filter(i=>i.text.toLowerCase().includes(B.toLowerCase())):d,[d,B]);return e.jsxs("div",{className:"flex flex-col h-full bg-slate-950 overflow-hidden relative",children:[e.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none overflow-hidden",children:[e.jsx(f.div,{animate:{scale:[1,1.2,1],x:[0,50,0],y:[0,30,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-[-10%] right-[-5%] w-[600px] h-[600px] bg-indigo-600/10 rounded-full blur-[120px]"}),e.jsx(f.div,{animate:{scale:[1,1.3,1],x:[0,-40,0],y:[0,-20,0]},transition:{duration:25,repeat:1/0,ease:"linear",delay:2},className:"absolute bottom-[-10%] left-[-5%] w-[500px] h-[500px] bg-violet-600/10 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute inset-0 premium-doodle opacity-30 mix-blend-overlay"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-transparent to-slate-950/50"})]}),e.jsxs("div",{className:"bg-slate-900/80 backdrop-blur-md px-4 py-3 flex items-center gap-3 sticky top-0 z-50 border-b border-white/5",children:[N&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/10 backdrop-blur-[1px]",onClick:()=>L(null)}),e.jsx("button",{onClick:C,className:"text-slate-400 hover:text-white transition-colors p-1 hover:bg-white/5 rounded-full",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>W(!0),children:[e.jsxs(we,{className:"w-10 h-10 border-2 border-slate-800 group-hover:border-indigo-500 transition-colors",children:[e.jsx(ge,{src:w||`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random&color=fff`}),e.jsx(ve,{className:"bg-slate-800 text-indigo-400 font-bold",children:(r||"?").charAt(0).toUpperCase()})]}),g&&!u&&e.jsx("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-slate-900 rounded-full animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>W(!0),children:[e.jsxs("h2",{className:"text-white font-bold truncate text-lg flex items-center gap-2",children:[r," ",u&&e.jsx("span",{className:"bg-slate-800 text-slate-400 text-[10px] px-1.5 py-0.5 rounded border border-white/5",children:"GROUP"})]}),!u&&e.jsx("div",{className:"text-xs flex items-center gap-1 h-4",children:e.jsx(A,{mode:"wait",children:h?e.jsxs(f.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"flex items-center gap-1.5 text-indigo-400 font-medium",children:[e.jsx("span",{className:"text-[10px]",children:"typing"}),e.jsx("span",{className:"flex gap-0.5",children:[0,1,2].map(i=>e.jsx(f.span,{animate:{y:[0,-2,0]},transition:{repeat:1/0,duration:.5,delay:i*.1},className:"w-1 h-1 bg-indigo-400 rounded-full"},i))})]}):g?e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"text-emerald-500 font-medium",children:"Online"}):e.jsx(f.span,{initial:{opacity:0},animate:{opacity:1},className:"text-slate-500",children:"Offline"})})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>_e(!ee),className:M("p-2 rounded-full transition-colors",ee?"text-indigo-400 bg-indigo-500/10":"text-slate-400 hover:text-white hover:bg-white/5"),children:e.jsx(je,{className:"w-5 h-5"})}),e.jsx("button",{onClick:l,className:"p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-colors",children:e.jsx(qe,{className:"w-5 h-5"})}),!u&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>T("audio"),className:"p-2 text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-full transition-colors",children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>T("video"),className:"p-2 text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-full transition-colors",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>de(!ce),className:"p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsx(A,{children:ce&&e.jsxs(f.div,{initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},className:"absolute top-full right-0 mt-2 w-48 bg-slate-900 border border-white/10 rounded-xl shadow-2xl py-1 z-[100] overflow-hidden",children:[e.jsx("button",{onClick:()=>{W(!0),de(!1)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-300 hover:bg-white/5 transition-colors",children:"Contact Info"}),e.jsx("button",{className:"w-full text-left px-4 py-2.5 text-sm text-slate-300 hover:bg-white/5 transition-colors",children:"Clear Chat"}),e.jsx("div",{className:"h-px bg-white/5 my-1"}),e.jsx("button",{onClick:C,className:"w-full text-left px-4 py-2.5 text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:"Close Chat"})]})})]})]})]}),e.jsx(A,{children:ee&&e.jsx(f.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-slate-900/50 backdrop-blur-md border-b border-white/5 px-4 py-2 relative z-40 overflow-hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search in conversation...",value:B,onChange:i=>te(i.target.value),className:"w-full bg-slate-950/50 border border-white/5 rounded-xl pl-10 pr-10 py-2 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all font-light"}),B&&e.jsx("button",{onClick:()=>te(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white",children:e.jsx(H,{className:"w-4 h-4"})})]})})}),e.jsxs("div",{ref:X,onScroll:De,className:"flex-1 overflow-y-auto overflow-x-hidden p-4 px-6 space-y-4 custom-scrollbar relative message-container-glass",children:[ie.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-tr from-indigo-500/20 to-violet-500/20 rounded-full flex items-center justify-center animate-pulse",children:e.jsx(Be,{className:"w-10 h-10 text-indigo-400"})}),e.jsxs("p",{className:"text-center font-medium",children:[B?"No matches found":"No messages yet.",e.jsx("br",{}),e.jsx("span",{className:"text-sm opacity-60",children:B?"Try searching for something else":"Start the conversation!"})]})]}):ie.map((i,P)=>e.jsx(Et,{message:i,currentUserId:a,partnerName:r,isGroup:u,isSequential:P>0&&ie[P-1].senderId===i.senderId,isMenuOpen:N===i.id,onToggleMenu:Fe,onReact:v,onReply:ze,onDelete:t,onEdit:Ue,onVote:S,setViewingFile:z,repliedMessage:i.replyToId?He.get(i.replyToId):null,language:_,t:o,formatMessageTime:Ee,renderFilePreview:Ve,onJoinGroup:U},i.id)),e.jsx("div",{ref:q})]}),E&&e.jsx(f.button,{initial:{scale:0},animate:{scale:1},onClick:()=>I("smooth"),className:"absolute bottom-24 right-6 bg-indigo-600 text-white p-3 rounded-full shadow-lg z-40 hover:bg-indigo-500 transition-colors",children:e.jsx(le,{className:"w-6 h-6 rotate-[-90deg]"})}),e.jsx(A,{children:x.length>0&&!B&&e.jsx(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"px-4 py-2 flex gap-2 overflow-x-auto no-scrollbar relative z-30",children:x.map((i,P)=>e.jsx("button",{onClick:()=>y(i),dir:/[\u0600-\u06FF]/.test(i)?"rtl":"ltr",className:M("whitespace-nowrap bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-300 border border-indigo-500/20 px-4 py-1.5 rounded-full text-xs font-medium transition-all backdrop-blur-md",/[\u0600-\u06FF]/.test(i)?"font-arabic":""),children:i},P))})}),e.jsx(Ft,{onSendMessage:y,currentUserId:a,replyTo:m,setReplyTo:j,onTyping:c,t:o,language:_,onSendVoiceMessage:k,editingMessage:ne,setEditingMessage:V,onEditMessage:p,scrollToBottom:Ae,isGroup:u,setShowPollCreator:he}),R&&e.jsx(_t,{url:R.url,type:R.type,name:R.name,onClose:()=>z(null)}),e.jsx(A,{children:Pe&&e.jsxs(e.Fragment,{children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm z-[90]",onClick:()=>W(!1)}),e.jsx(Pt,{partnerId:n,partnerName:r,partnerAvatar:w,isGroup:u,onClose:()=>W(!1),messages:d,onOpenGallery:()=>{xe(!0),W(!1)},onAudioCall:()=>T("audio"),onVideoCall:()=>T("video"),onShowProfile:()=>{$(n),W(!1)},language:_,t:o})]})}),e.jsx(A,{children:Le&&e.jsx(Lt,{messages:d,onClose:()=>xe(!1)})}),e.jsx(A,{children:$e&&e.jsx($t,{onClose:()=>he(!1),onSend:b})})]})}const Zt=s.memo(zt);export{Zt as ChatWindow};
